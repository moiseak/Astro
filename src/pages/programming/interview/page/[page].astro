---
import BaseLayout from '../../../../layouts/BaseLayout.astro';
// 定义文章的类型接口
interface BlogPost {
  frontmatter: {
    title: string;
    pubDate: string;
    description?: string;
  };
  url: string;
}

export async function getStaticPaths({ paginate }) {
  const posts = await Promise.all(
    Object.values(
      import.meta.glob<BlogPost>("/src/pages/posts/interview/*.md", { eager: true })
    )
  );
  const sortedPosts = posts.sort((a, b) => {
    const dateA = new Date(a.frontmatter.pubDate);
    const dateB = new Date(b.frontmatter.pubDate);
    return dateB.getTime() - dateA.getTime();
  });
  
  return paginate(sortedPosts, { pageSize: 7 });
}

const { page } = Astro.props;
---

<BaseLayout title="面经">
  <section class="posts">
    {page.data.map((post) => (
      <article class="post-preview">
        <h2>
          <a href={post.url}>{post.frontmatter.title}</a>
        </h2>
        <div class="post-meta">
          <time>{new Date(post.frontmatter.pubDate).toLocaleDateString()}</time>
          {post.frontmatter.description && (
            <span class="description">{post.frontmatter.description}</span>
          )}
        </div>
      </article>
    ))}
  </section>

  <nav class="pagination">
    {page.url.prev && <a href={page.url.prev} class="prev">上一页</a>}
    <span class="current">第 {page.currentPage} 页 / 共 {page.lastPage} 页</span>
    {page.url.next && <a href={page.url.next} class="next">下一页</a>}
  </nav>
</BaseLayout>

<style>
    .posts {
      display: grid;
      gap: 0.5rem;
      margin: 1rem 0;
    }
  
    .post-preview {
      padding: 1rem;
      border-bottom: 1px solid #eee;
    }
  
    .post-meta {
      color: #666;
      font-size: 0.9rem;
      margin: 0.5rem 0;
      display: flex;
      gap: 1rem;
      align-items: center;
    }
  
    .description {
      color: #666;
      font-style: italic;
    }
  
    a {
      text-decoration: none;
      color: inherit;
    }
  
    a:hover {
      color: #3b82f6;
    }
  
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      margin-top: 2rem;
      padding: 1rem;
    }
  
    .pagination a {
      padding: 0.5rem 1rem;
      border: 1px solid #eee;
      border-radius: 4px;
      transition: all 0.2s;
    }
  
    .pagination a:hover {
      background: rgba(59, 130, 246, 0.05);
    }
  
    .current {
      color: #666;
    }
</style>